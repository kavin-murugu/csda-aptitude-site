<!DOCTYPE html>
<html>
<head><title>CSDA Aptitude Login</title></head>
<body>
  <h2>Login with Google</h2>
  <button onclick="login()">Login</button>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js"></script>
  <script src="firebase-config.js"></script>
  <script>
    function login() {
      var provider = new firebase.auth.GoogleAuthProvider();
      firebase.auth().signInWithPopup(provider).then((result) => {
        const email = result.user.email;
        const uid = result.user.uid;
        // Check user role
        firebase.firestore().collection("users")
          .where("email", "==", email)
          .get().then(snapshot => {
            if (!snapshot.empty) {
              const user = snapshot.docs[0].data();
              if (user.role === "admin") {
                window.location.href = "admin.html";
              } else {
                window.location.href = "student.html";
              }
            } else {
              alert("You are not authorized. Ask admin.");
            }
          });
      });
    }
  </script>
</body>
</html>
